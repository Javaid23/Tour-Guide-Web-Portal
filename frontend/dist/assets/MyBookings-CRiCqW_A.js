import{j as e}from"./index-Cu-NLfXN.js";import{r as t}from"./router-Dd4lY5Dn.js";import{c as s}from"./api-CQ5h52SX.js";import{p as o,k as a,J as n}from"./icons-D1SVnQiw.js";import"./vendor-Z2Iecplj.js";const i=()=>{const[i,l]=t.useState([]),[r,d]=t.useState(!0),[c,m]=t.useState("");t.useEffect(()=>{const e=async()=>{try{console.log("📋 Fetching user bookings...");const e=await s.getUserBookings();console.log("✅ Bookings fetched:",e.data),l(e.data.bookings||e.data||[])}catch(e){console.error("❌ Failed to load bookings:",e),m("Failed to load bookings")}finally{d(!1)}};e();const t=()=>{console.log("🔄 New booking created, refreshing list..."),e()};return window.addEventListener("bookingCreated",t),()=>{window.removeEventListener("bookingCreated",t)}},[]);return r?e.jsx("div",{className:"text-center py-20",children:"Loading..."}):e.jsx("div",{className:"flex justify-center items-center min-h-[70vh] bg-gradient-to-br from-blue-50 to-blue-100 py-10 px-2",children:e.jsxs("div",{className:"w-full max-w-3xl",children:[e.jsx("h2",{className:"text-3xl font-bold mb-8 text-blue-800",children:"My Bookings"}),0===i.length?e.jsx("div",{className:"bg-white rounded-xl shadow p-8 text-center text-blue-600 font-medium",children:"No bookings found."}):e.jsx("ul",{className:"space-y-6",children:i.map(t=>e.jsxs("li",{className:"bg-white border border-blue-100 rounded-2xl shadow-lg p-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4 transition-all",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-bold text-lg text-blue-700 flex items-center gap-2",children:[e.jsx(o,{className:"text-green-500",size:18}),t.tour?.name||t.destination?.name||t.tourName||t.destinationName||"Booking"]}),e.jsxs("div",{className:"text-gray-500 flex items-center gap-2 mt-1",children:[e.jsx(a,{size:16}),"Date: ",t.startDate?t.startDate.slice(0,10):t.date||t.createdAt?.slice(0,10)]}),e.jsxs("div",{className:"text-sm mt-1",children:["Status: ",e.jsx("span",{className:"cancelled"===t.status?"text-red-500":"text-green-600",children:t.status})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:t.tour?"Tour Booking":t.destination?"Destination Booking":""})]}),"cancelled"!==t.status&&e.jsxs("button",{onClick:()=>(async e=>{if(window.confirm("Cancel this booking?"))try{await s.cancelBooking(e),l(i.filter(t=>t._id!==e)),m("Booking cancelled.")}catch(t){m(t.message)}})(t._id),className:"w-full md:w-auto mt-4 md:mt-0 py-2 px-6 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-lg font-semibold text-base transition-all duration-300 hover:from-blue-700 hover:to-blue-800 shadow-md flex items-center justify-center gap-2",children:[e.jsx(n,{size:18,className:"inline-block mr-1"})," Cancel"]})]},t._id))}),c&&e.jsx("div",{className:"mt-6 text-center text-blue-600 font-medium",children:c})]})})};export{i as default};
