import{A as e,j as s}from"./index-Cu-NLfXN.js";import{r as a}from"./router-Dd4lY5Dn.js";import{U as t,x as l,k as r,e as i,u as n,g as d,t as c,S as o,y as x,c as m,z as g,J as u,K as h,N as b}from"./icons-D1SVnQiw.js";import"./vendor-Z2Iecplj.js";const j=()=>{const{user:j,logout:p}=a.useContext(e),[y,N]=a.useState(null),[f,v]=a.useState([]),[w,S]=a.useState([]),[k,A]=a.useState([]),[P,R]=a.useState({}),[D,L]=a.useState([]),[C,T]=a.useState("personal"),[z,B]=a.useState(!0),[E,F]=a.useState(""),[$,q]=a.useState(!1),[G,I]=a.useState(!1),[K,_]=a.useState({currentPassword:"",newPassword:"",confirmPassword:""});a.useEffect(()=>{M()},[]);const M=async()=>{try{B(!0);const e={Authorization:`Bearer ${localStorage.getItem("token")}`},s=await fetch("/api/guide/profile",{headers:e});if(s.ok){const e=await s.json();N(e.guide)}const a=await fetch("/api/guide/bookings",{headers:e});if(a.ok){const e=await a.json();v(e.bookings||[])}const t=await fetch("/api/guide/reviews",{headers:e});if(t.ok){const e=await t.json();S(e.reviews||[])}A([]);const l=await fetch("/api/guide/availability",{headers:e});if(l.ok){const e=await l.json();R(e.availability||{})}const r=await fetch("/api/guide/notifications",{headers:e});if(r.ok){const e=await r.json();L(e.notifications||[])}}catch(e){F("Failed to load guide data")}finally{B(!1)}};if(z)return s.jsx("div",{className:"text-center py-20",children:"Loading..."});const O=[{id:"personal",name:"Personal Info",icon:l},{id:"bookings",name:"Assigned Bookings",icon:r},{id:"reviews",name:"Reviews",icon:i},{id:"earnings",name:"Earnings",icon:n},{id:"availability",name:"Availability",icon:d},{id:"notifications",name:"Notifications",icon:c},{id:"security",name:"Security",icon:o},{id:"settings",name:"Settings",icon:x}];return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 py-6 px-4",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[y?.profilePhoto&&s.jsx("img",{src:`/uploads/guides/${y.profilePhoto}`,alt:"Profile",className:"w-16 h-16 rounded-full object-cover border-4 border-blue-200"}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:[y?.firstName," ",y?.lastName||""]}),s.jsxs("p",{className:"text-gray-600 flex items-center gap-2",children:[s.jsx(t,{className:"w-4 h-4"}),"Tour Guide Account"]}),s.jsx("p",{className:"text-sm text-gray-500",children:y?.email})]})]})}),s.jsx("div",{className:"bg-white rounded-2xl shadow-lg mb-6",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"flex space-x-8 overflow-x-auto p-4",children:O.map(e=>{const a=e.icon;return s.jsxs("button",{onClick:()=>T(e.id),className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap "+(C===e.id?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-blue-600"),children:[s.jsx(a,{className:"w-4 h-4"}),e.name]},e.id)})})})}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[E&&s.jsx("div",{className:"mb-6 p-4 rounded-lg "+(E.includes("success")||E.includes("updated")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:E}),"personal"===C&&s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[s.jsx(l,{className:"text-blue-500"}),"Personal Information"]}),y&&s.jsxs("div",{className:"space-y-6 max-w-lg",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block mb-2 font-medium text-gray-800",children:"Full Name"}),s.jsx("input",{value:y.firstName+" "+(y.lastName||""),disabled:!0,className:"w-full border-2 border-gray-200 px-4 py-3 rounded-lg bg-gray-100 text-gray-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block mb-2 font-medium text-gray-800",children:"Email Address"}),s.jsx("input",{value:y.email,disabled:!0,className:"w-full border-2 border-gray-200 px-4 py-3 rounded-lg bg-gray-100 text-gray-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block mb-2 font-medium text-gray-800",children:"Phone Number"}),s.jsx("input",{value:y.phone,disabled:!0,className:"w-full border-2 border-gray-200 px-4 py-3 rounded-lg bg-gray-100 text-gray-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block mb-2 font-medium text-gray-800",children:"Languages"}),s.jsx("input",{value:y.languages?.join(", "),disabled:!0,className:"w-full border-2 border-gray-200 px-4 py-3 rounded-lg bg-gray-100 text-gray-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block mb-2 font-medium text-gray-800",children:"Specializations"}),s.jsx("input",{value:y.specializations?.join(", "),disabled:!0,className:"w-full border-2 border-gray-200 px-4 py-3 rounded-lg bg-gray-100 text-gray-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block mb-2 font-medium text-gray-800",children:"Preferred Regions"}),s.jsx("input",{value:y.preferredRegions?.join(", "),disabled:!0,className:"w-full border-2 border-gray-200 px-4 py-3 rounded-lg bg-gray-100 text-gray-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block mb-2 font-medium text-gray-800",children:"Hourly Rate"}),s.jsx("input",{value:y.hourlyRate?`PKR ${y.hourlyRate}`:"",disabled:!0,className:"w-full border-2 border-gray-200 px-4 py-3 rounded-lg bg-gray-100 text-gray-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block mb-2 font-medium text-gray-800",children:"Status"}),s.jsx("div",{className:"p-3 rounded-lg border "+("approved"===y.status?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"),children:s.jsx("span",{className:"font-medium "+("approved"===y.status?"text-green-700":"text-yellow-700"),children:"approved"===y.status?"Active Guide":y.status})})]})]})]}),"bookings"===C&&s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[s.jsx(r,{className:"text-blue-500"}),"Assigned Bookings (",f.length,")"]}),0===f.length?s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(r,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No bookings assigned yet"})]}):s.jsx("div",{className:"space-y-4",children:f.map((e,a)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:e.tour?.title||`Booking #${a+1}`}),s.jsxs("p",{className:"text-gray-600 flex items-center gap-1",children:[s.jsx(m,{className:"w-4 h-4"}),e.tour?.location||"Location TBA"]})]}),s.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium capitalize "+("completed"===e.status?"bg-green-100 text-green-800":"confirmed"===e.status?"bg-blue-100 text-blue-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Date:"})," ",e.tourDate?new Date(e.tourDate).toLocaleDateString():"TBA"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Tourist:"})," ",e.user?.firstName," ",e.user?.lastName]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Group Size:"})," ",e.groupSize]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Total Amount:"})," PKR ",e.totalAmount?.toLocaleString()]})]}),e.specialRequests&&s.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[s.jsx("strong",{children:"Special Requests:"})," ",e.specialRequests]})]},e._id||a))})]}),"reviews"===C&&s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[s.jsx(i,{className:"text-blue-500"}),"Reviews"]}),0===w.length?s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(i,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No reviews yet"})]}):s.jsx("div",{className:"space-y-4",children:w.map(e=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:e.tour?.title||"Tour Review"}),s.jsxs("p",{className:"text-gray-600",children:["Tourist: ",e.user?.firstName," ",e.user?.lastName]})]}),s.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((a,t)=>s.jsx(i,{className:"w-4 h-4 "+(t<e.rating?"text-yellow-400 fill-current":"text-gray-300")},t))})]}),s.jsx("p",{className:"text-gray-700 mb-3",children:e.comment}),s.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[s.jsxs("span",{children:["Submitted on ",new Date(e.createdAt).toLocaleDateString()]}),s.jsx("span",{className:"px-2 py-1 rounded bg-green-100 text-green-700",children:"Approved"})]})]},e._id))})]}),"earnings"===C&&s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[s.jsx(n,{className:"text-blue-500"}),"Earnings"]}),s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(n,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"Earnings summary coming soon"})]})]}),"availability"===C&&s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[s.jsx(d,{className:"text-blue-500"}),"Availability"]}),s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(d,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"Availability calendar coming soon"})]})]}),"notifications"===C&&s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[s.jsx(c,{className:"text-blue-500"}),"Notifications"]}),0===D.length?s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(c,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No notifications"})]}):s.jsx("div",{className:"space-y-4",children:D.map(e=>s.jsxs("div",{className:"border rounded-lg p-4 "+(e.read?"bg-gray-50":"bg-blue-50 border-blue-200"),children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h3",{className:"font-semibold",children:e.title}),s.jsx("span",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]}),s.jsx("p",{className:"text-gray-700",children:e.message})]},e._id))})]}),"security"===C&&s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[s.jsx(o,{className:"text-blue-500"}),"Security Settings"]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Password"}),s.jsx("p",{className:"text-gray-600 mb-3",children:"Change your account password"}),s.jsx("button",{onClick:()=>q(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Change Password"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Two-Factor Authentication"}),s.jsx("p",{className:"text-gray-600 mb-3",children:"Add an extra layer of security to your account"}),s.jsx("button",{className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Enable 2FA (Coming Soon)"})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Active Sessions"}),s.jsx("p",{className:"text-gray-600 mb-3",children:"Log out of all devices"}),s.jsxs("button",{className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2",children:[s.jsx(g,{className:"w-4 h-4"}),"Log Out All Sessions"]})]})]})]}),"settings"===C&&s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[s.jsx(x,{className:"text-blue-500"}),"Account Settings"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("button",{className:"w-full text-left p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Notification Preferences"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Manage email and push notifications"})]}),s.jsx(c,{className:"w-5 h-5 text-gray-400"})]})}),s.jsx("button",{onClick:p,className:"w-full text-left p-4 border border-red-200 rounded-lg hover:bg-red-50 text-red-600",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Logout"}),s.jsx("p",{className:"text-sm",children:"Sign out of your account"})]}),s.jsx(u,{className:"w-5 h-5"})]})})]})]})]}),s.jsxs("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-2xl p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-red-800 mb-2 flex items-center gap-2",children:[s.jsx(h,{className:"w-5 h-5"}),"Danger Zone"]}),s.jsx("p",{className:"text-red-700 mb-4",children:"Once you delete your account, there is no going back. Please be certain."}),s.jsxs("button",{onClick:()=>I(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[s.jsx(b,{className:"w-4 h-4"}),"Delete My Account"]})]})]})})};export{j as default};
